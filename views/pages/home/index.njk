{% include "./style.njk" %}
<div class="carousel slide" id="carouselHome" data-ride="carousel">
	<div class="carousel-inner">
		<ol class="carousel-indicators">
			<li data-target="#carouselHome" data-slide-to="0" class="active"></li>
			<li data-target="#carouselHome" data-slide-to="1"></li>
			<li data-target="#carouselHome" data-slide-to="2"></li>
		</ol>

		{% query 'posts', {type: 'news'}, {sort: [['date', -1]], limit: 3}, 'posts' %}
		{% for post in posts %}
			{% lookup 'users', {_id: post.author}, 'author' %}
			<div class="carousel-item {% if loop.first %}active{% endif %}">
				<img class="ml-auto" src="{{post.img}}" alt="{{post.title}}" width="100%" />
				<div class="carousel-caption px-5">
					<h5><a class="text-white" href="{{post.slug}}">{{post.title}}</a></h5>
					<h6><a class="text-white" href="/members/{{author.nicename}}">{{author.display_name}}</a> / {{crp.util.dateToStr(post.date)}}</h6>
					<p>{{post.content | safe | striptags(true) | truncate(150)}}</p>
					<p><a class="text-white" href="{{post.slug}}">Read More</a></p>
				</div>
			</div>
		{% endfor %}

		<a class="carousel-control-prev" href="#carouselHome" role="button" data-slide="prev">
			<span class="carousel-control-prev-icon" aria-hidden="true"></span>
			<span class="sr-only">Previous</span>
		</a>
		<a class="carousel-control-next" href="#carouselHome" role="button" data-slide="next">
			<span class="carousel-control-next-icon" aria-hidden="true"></span>
			<span class="sr-only">Next</span>
		</a>
	</div>
</div>

<div class="container mt-3">
	<div class="row featured-content">
		{% query 'posts', {type: 'featured_content'}, {sort: [['date', -1]], limit: 3}, 'posts' %}
		{% for post in posts %}
			<div class="col-lg-4">
				<div class="card shadow-sm">
					<img class="card-img-top" src="{{post.img}}" alt="">
					<div class="card-body">
						<h5 class="card-title"><a href="{{post.slug}}">{{post.title}}</a></h5>
						<h6 class="card-subtitle text-muted">{{crp.moment(post.date).fromNow()}}</h6>
						<p class="card-text">{{post.content | safe | striptags(true) | truncate(100)}}</p>
						<a class="card-link" href="{{post.slug}}">Read More</a>
					</div>
				</div>
			</div>
		{% endfor %}
	</div>

	<div class="row recent-posts">

	</div>
</div>
