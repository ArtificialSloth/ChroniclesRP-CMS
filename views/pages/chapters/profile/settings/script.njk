<script>
	$('#chapter-form').submit((e) => {
		e.preventDefault();
		tinymce.triggerSave();

		var formData = new FormData(e.target);
		crpAjaxUpload('/api/edit-chapter', formData, (res) => {
			if (true) {
				crpGetPage(window.location.pathname);
			} else if (res == 'noGame') {
				$('#chapter-form-').next('.invalid-feedback').html('You must select a valid game.');
				$('#chapter-form-').addClass('is-invalid');
			} else if (res == 'badDiscord') {
				$('#chapter-form-').next('.invalid-feedback').html('Discord ID invalid!');
				$('#chapter-form-').addClass('is-invalid');
			} else if (res == 'badTagline') {
				$('#chapter-form-').next('.invalid-feedback').html('Tagline must be less than 140 characters!');
				$('#chapter-form-').addClass('is-invalid');
			} else if (res.code == 'LIMIT_FILE_SIZE' && res.field == 'profile_pic') {
				$('#chapter-form-').next('.invalid-feedback').html('File size must be < 2 MB');
				$('#chapter-form-').addClass('is-invalid');
			} else if (res.code == 'LIMIT_FILE_SIZE' && res.field == 'cover_pic') {
				$('#chapter-form-').next('.invalid-feedback').html('File size must be < 2 MB');
				$('#chapter-form-').addClass('is-invalid');
			} else {
				console.error(res);
				$('#chapter-form-').next('.invalid-feedback').html('Something went wrong :(');
				$('#chapter-form-').addClass('is-invalid');
			}
		});
	});
</script>
