{% include "./style.njk" %}
{% query 'users', {}, {login: 1}, 'users' %}

{% set administrators = crp.util.filterObject(users, 'role', 'administrator') %}
{% set chapterLeaders = crp.util.filterObject(users, 'role', 'chapter_leader') %}
{% set members = crp.util.filterObject(users, 'role', 'member') %}
{% set pendings = crp.util.filterObject(users, 'role', 'pending') %}

<div class="users-menu">
	<button class="filter all active" onclick="usersToggleRoleFilter(this, 'all')">All ({{users.length}})</button>

	{% if administrators.length > 0 %}
		<button class="filter administrator" onclick="usersToggleRoleFilter(this, 'administrator')">Administrators ({{administrators.length}})</button>
	{% endif %}

	{% if chapterLeaders.length > 0 %}
		<button class="filter chapter-leader" onclick="usersToggleRoleFilter(this, 'chapter-leader')">Chapter Leaders ({{chapterLeaders.length}})</button>
	{% endif %}

	{% if members.length > 0 %}
		<button class="filter member" onclick="usersToggleRoleFilter(this, 'member')">Members ({{members.length}})</button>
	{% endif %}

	{% if pendings.length > 0 %}
		<button class="filter pending" onclick="usersToggleRoleFilter(this, 'pending')">Pending ({{pendings.length}})</button>
	{% endif %}
</div>

<div class="users-content">
	<div class="table">
		<div class="table-row table-header">
			<div class="table-header-data">Username</div>
			<div class="table-header-data">Email</div>
			<div class="table-header-data">Role</div>
		</div>
		<div class="filter all active">
			{% for user in users %}
				{% include "./loop.njk" %}
			{% endfor %}
		</div>
		<div class="filter administrator">
			{% for user in administrators %}
				{% include "./loop.njk" %}
			{% endfor %}
		</div>
		<div class="filter chapter-leader">
			{% for user in chapterLeaders %}
				{% include "./loop.njk" %}
			{% endfor %}
		</div>
		<div class="filter member">
			{% for user in members %}
				{% include "./loop.njk" %}
			{% endfor %}
		</div>
		<div class="filter pending">
			{% for user in pendings %}
				{% include "./loop.njk" %}
			{% endfor %}
		</div>
	</div>
</div>

<fieldset class="add-user">
	<legend>Add a New User</legend>
	<form>
		<label for="user_login">Username: </label>
		<input type="text" name="user_login" class="user_login" autocomplete="off" />
		<br />
		<label for="user_email">Email: </label>
		<input type="text" name="user_email" class="user_email" autocomplete="off" />
		<br />
		<label for="user_pass">Password: </label>
		<input type="password" name="user_pass" class="user_pass" autocomplete="off" />
		<input type="checkbox" name="encrypted" class="encrypted" autocomplete="off" />
		<label for="encrypted">Encrypted</label>
		<br />
		<label for="register_date">Registration Date: </label>
		<input type="text" name="register_date" class="register_date" autocomplete="off" />

		<input type="submit" value="Add User" />
	</form>
</fieldset>

{% include "./script.njk" %}
